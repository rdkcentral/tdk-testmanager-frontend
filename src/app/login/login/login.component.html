<!--
If not stated otherwise in this file or this component's Licenses.txt file the
following copyright and licenses apply:
Copyright 2024 RDK Management
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<nav class="navbar navbar-expand-lg header">
  <!-- Container for navigation bar content -->
  <div class="container-fluid">
    <a class="navbar-brand"></a>
    <img src="assets/logo/TDKLogoFinal.png" alt="TDK_logo" class="logo-img img-fluid" />
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText"
      aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <!-- Collapsible navigation content -->
    <div class="collapse navbar-collapse" id="navbarText">
    </div>
  </div>
</nav>

<!-- Main container for login and registration forms -->
<div class="container-fluid">
  <!-- Row for form content -->
  <div class="row">
    <!-- Column for form wrapper -->
    <div class="col">
      <!-- Parent container for form -->
      <div class="parent">
        <!-- Container for form box and toggle panels -->
        <div class="container container-box" [ngClass]="isSigninVisible?'active':''" id="container-box">
          <!-- Form container for user registration -->
          <div class="form-container sign-up" *ngIf="registerVisible && currentForm === 'register'">
            <h1 class="title">Register User</h1>
            @if (showHideRegForm) {
            <!-- Registration form -->
            <form [formGroup]="registerForm" (ngSubmit)="onRegister()" class="registerform">
              <!-- Row for username input -->
              <div class="row mb-1">
                <label for="regusername" class="col-md-4 col-form-label">User Name<span style="color:red; margin-left: 0.75em;">*</span></label>
                <!-- Column for username input field -->
                <div class="col-md-8">
                  <input type="text" class="form-control" id="regusername" formControlName="regusername"
                    placeholder="Enter user name">
                  <div *ngIf="regSubmitted && registerForm.controls['regusername']?.errors " class="text-danger">
                    <small *ngIf="registerForm.controls['regusername']?.errors?.['required']">Please enter user
                      name.</small>
                    <small *ngIf="registerForm.controls['regusername']?.errors?.['minlength']">User name minimum 3
                      characters.</small>
                  </div>
                  <div *ngIf="backendErrors['regusername']" class="error">
                      <small class="backend-error">{{ backendErrors['regusername'] }}</small> 
                  </div>
                </div>
              </div>
              <!-- Row for password input -->
              <div class="row mb-1">
                <label for="regpassword" class="col-md-4 col-form-label">Password<span style="color:red; margin-left: 0.75em;">*</span></label>
                <!-- Column for password input field -->
                <div class="col-md-8 eye-align">
                  <input type="password" id="regpassword" class="form-control" [type]="showViewPasswordOnPress ? 'password' : 'text'" formControlName="regpassword"
                    placeholder="Enter password">
                    <span class="registerEyeicon" (click)="viewRegisterPassword()">
                      <i [ngClass]="showViewPasswordOnPress?'bi bi-eye-slash':'bi bi-eye'"></i>
                    </span>
                  <div *ngIf="regSubmitted && registerForm.controls['regpassword']?.errors" class="text-danger">
                    <small *ngIf="registerForm.controls['regpassword']?.errors?.['required']">Please enter
                      password.</small>
                    <small *ngIf="registerForm.controls['regpassword']?.errors?.['minlength']">Password must be at least 6 characters long.</small>
                  </div>
                </div>
              </div>
              <!-- Row for retype password input -->
              <div class="row mb-1">
                <label for="retypepassword" class="col-md-4 col-form-label">Retype Password<span style="color:red; margin-left: 0.75em;">*</span></label>
                <!-- Column for retype password input field -->
                <div class="col-md-8 eye-align">
                  <input type="password" id="retypepassword" class="form-control" [type]="showConfirmPasswordOnPress ? 'password' : 'text'" formControlName="retypepassword"
                    placeholder="Enter retype password">
                    <span class="confirmEyeicon" (click)="viewConfirmPassword()">
                      <i [ngClass]="showConfirmPasswordOnPress?'bi bi-eye-slash':'bi bi-eye'"></i>
                    </span>
                  <div *ngIf="regSubmitted && registerForm.controls['retypepassword']?.errors" class="text-danger">
                    <small *ngIf="registerForm.controls['retypepassword']?.errors?.['required']">Please enter retype
                      password.</small>
                    <small *ngIf="registerForm.controls['retypepassword']?.errors?.['passwordMatchValidator']">Password
                      didn't match.</small>
                  </div>
                </div>
              </div>
              <!-- Row for email input -->
              <div class="row mb-1">
                <label for="regemail" class="col-md-4 col-form-label">Email</label>
                <!-- Column for email input field -->
                <div class="col-md-8">
                  <input type="text" id="regemail" class="form-control" formControlName="regemail"
                    placeholder="Enter email">
                  <div *ngIf="regSubmitted && registerForm.controls['regemail']?.errors" class="text-danger">
                    <small *ngIf="registerForm.controls['regemail']?.errors?.['required']">Please enter email.</small>
                    <small *ngIf="registerForm.controls['regemail']?.errors?.['pattern']">Please enter valid
                      email.</small>
                  </div>
                  <div *ngIf="backendErrors['regemail']" class="error">
                   <small class="backend-error">{{ backendErrors['regemail'] }}</small> 
                  </div>
                </div>
              </div>
              <!-- Row for display name input -->
              <div class="row mb-1">
                <label for="displayname" class="col-md-4 col-form-label">Display Name<span style="color:red; margin-left: 0.75em;">*</span></label>
                <!-- Column for display name input field -->
                <div class="col-md-8">
                  <input type="text" class="form-control" id="displayname" formControlName="displayname"
                    placeholder="Enter display name">
                  <div *ngIf="regSubmitted && registerForm.controls['displayname']?.errors" class="text-danger">
                    <small *ngIf="registerForm.controls['displayname']?.errors?.['required']">Please enter display
                      name.</small>
                  </div>
                </div>
              </div>
              <!-- Row for prefered category select -->
              <div class="row mb-1">
                <label for="preferCategoty" class="col-md-4 col-form-label">Prefered Category<span style="color:red; margin-left: 0.75em;">*</span></label>
                <!-- Column for prefered category select field -->
                <div class="col-md-8">
                  <select class="form-select" aria-label="Default select example" id="preferCategoty"
                    formControlName="preferCategoty" (change)="changeCategory($event)">
                    <option value="" default>Select</option>
                    <option value="RDKV">Video</option>
                    <option value="RDKB">Broadband</option>
                  </select>
                  <div *ngIf="regSubmitted && registerForm.controls['preferCategoty']?.errors" class="text-danger">
                    <small *ngIf="registerForm.controls['preferCategoty']?.errors?.['required']">Please select prefered category.</small>
                  </div>
                </div>
              </div>
              <!-- Row for register button -->
              <div class="row mt-1">
                <!-- Column for register button -->
                <div class="text-end">
                  <button type="submit" class="registerme-btn">Register Me</button>
                </div>
              </div>
            </form>
            }

            @if (showHideRegSucess) {
            <!-- Registration success message container -->
            <div class="text-success text-center regsuccess">
              <span class="successicon"><i class="bi bi-check2-circle"></i></span>
              <h5 class="messagetitle">{{registerSuccess}}</h5><span class="subtitle">Please click on Sign In to
                continue...</span>
            </div>
            }
          </div>
          <!-- Form container for user sign-in -->
          <div class="form-container sign-in" *ngIf="signinVisible && currentForm === 'signin'">

            <h1 class="title">Sign In</h1>
            <!-- Sign-in form -->
            <form [formGroup]="signinForm" (ngSubmit)="onSubmit()" class="signinform">
              <!-- Row for username input -->
              <div class="row mb-4">
                <label for="username" class="col-md-4 col-form-label">User Name</label>
                <!-- Column for username input field -->
                <div class="col-md-8">
                  <input type="text" class="form-control" id="username" formControlName="username" name="username"
                    autocomplete="off" placeholder="Enter User Name">
                  <div *ngIf="submitted && signinForm.controls['username'].errors" class="text-danger">
                    <small *ngIf="signinForm.controls['username'].errors['required']">Please enter user name.</small>
                    <small *ngIf="signinForm.controls['username'].errors['minlength']">User name minimum 4
                      characters.</small>
                  </div>
                </div>
              </div>
              <!-- Row for password input -->
              <div class="row mb-4">
                <label for="password" class="col-md-4 col-form-label">Password</label>
                <!-- Column for password input field -->
                <div class="col-md-8">
                  <input type="password" class="form-control" id="password" [type]="showPasswordOnPress ? 'password' : 'text'" formControlName="password"
                    placeholder="Enter Password">
                    <span class="eyeicon" (click)="viewPassword()">
                      <i [ngClass]="showPasswordOnPress?'bi bi-eye-slash':'bi bi-eye'"></i>
                    </span>
                  <div *ngIf="submitted && signinForm.controls['password'].errors" class="text-danger">
                    <small *ngIf="signinForm.controls['password'].errors['required']">Please enter password.</small>
                    <small *ngIf="signinForm.controls['password'].errors['minlength']">Password minimum 4
                      characters.</small>
                  </div>
                </div>
              </div>
              @if (showhideErr) {
              <div class="err text-danger text-center">
                <small>{{errorMessage}}</small>
              </div>
              }
              <!-- Row for sign-in button -->
              <div class="row mt-4">
                <!-- Container for sign-in button -->
                <div class="signinbtn">
                  <button type="submit">Sign In</button>
                  <!-- Commented for now .Need to implement forgot password later -->
                  <!-- <div class="mt-2">
                    <a routerLink="/forgot-password"><i class="bi bi-arrow-right-short"></i> Forgot Password ? <i
                        class="bi bi-arrow-left-short"></i></a>
                  </div> -->
                </div>
              </div>
            </form>
          </div>
          <!-- Form container for LDAP sign-in -->
          <div class="form-container sign-in" *ngIf="ldapScreenVisible">
            <h1 class="title">Sign In</h1>
            <!-- Login option radio buttons -->
            <div class="logingOption text-center">
              <!-- Button group for sign-in options -->
              <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" name="btnradio" id="usersignin" (change)="isldapChecked($event)">
                <label class="btn btn-outline-primary logingOptionlbl" for="usersignin">User Sign In</label>

                <input type="radio" class="btn-check" name="btnradio" id="ldapsignin" checked>
                <label class="btn btn-outline-primary logingOptionlbl" for="ldapsignin">LDAP Sign In</label>
              </div>
            </div>
            <!-- LDAP sign-in form -->
            <form [formGroup]="ldapForm" (ngSubmit)="onLdapSubmit()">
              <!-- Row for LDAP username input -->
              <div class="row mb-4">
                <label for="username" class="col-md-4 col-form-label">User Name</label>
                <!-- Column for LDAP username input field -->
                <div class="col-md-8">
                  <input type="text" class="form-control" id="username" formControlName="username"
                    placeholder="Enter User Name">
                  <div *ngIf="ldapSubmitted && ldapForm.controls['username'].errors" class="text-danger">
                    <small *ngIf="ldapForm.controls['username'].errors['required']">Please enter user name.</small>
                  </div>
                </div>
              </div>
              <!-- Row for LDAP password input -->
              <div class="row mb-4">
                <label for="password" class="col-md-4 col-form-label">Password</label>
                <!-- Column for LDAP password input field -->
                <div class="col-md-8">
                  <input type="password" class="form-control" id="password" formControlName="password"
                    placeholder="Enter Password">
                  <div *ngIf="ldapSubmitted && ldapForm.controls['password'].errors" class="text-danger">
                    <small *ngIf="ldapForm.controls['password'].errors['required']">Please enter password.</small>
                  </div>
                </div>
              </div>
              <!-- Row for LDAP sign-in button -->
              <div class="row">
                <!-- Container for LDAP sign-in button -->
                <div class="mt-2 signinbtn">
                  <button type="submit">Sign In</button>
                </div>
              </div>
            </form>
          </div>
          <!-- Container for toggle panels -->
          <div class="toggle-container">
            <!-- Toggle panel wrapper -->
            <div class="toggle">
              <!-- Left toggle panel for sign-in -->
              <div class="toggle-panel toggle-left">
                <!-- <h1>Welcome Back!</h1> -->
                <p>Enter your user details to sign in</p>
                <button class="signin" id="login" (click)="toogleForm('signin')">Sign In</button>
              </div>
              <!-- Right toggle panel for registration -->
              <div class="toggle-panel toggle-right">
                <p>Register with your details</p>
                <button class="signup" id="register" (click)="toogleForm('register')">Register</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>