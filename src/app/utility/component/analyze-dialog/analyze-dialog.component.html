<!--
If not stated otherwise in this file or this component's Licenses.txt file the
following copyright and licenses apply:
Copyright 2024 RDK Management
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!--
  Main container for the analyze dialog component.
-->

<div class="container-fluid">
  <!--
    Row for the main content area.
  -->

  <div class="row mt-2">
    <!--
      Column for the main content, full width on medium and up.
    -->

    <div class="col-md-12">

      <!--
        Title for the JIRA view.
      -->
      <h1 class="view-title">{{jiraTitel}}</h1>

      <!--
        Section for ticket creation and details.
      -->

      <div class="ticket-sec mt-2">
        <!--
          Section for creating a new JIRA ticket, visible if isCreateJira is true.
        -->

        <div class="create-section" *ngIf="isCreateJira">
          <!--
            Row for project selection dropdown.
          -->

          <div class="row">
            <label for="staticEmail" class="col-sm-6 col-form-label">Select Project ID :</label>
            <!--
              Column for the project selection dropdown.
            -->

            <div class="col-sm-6">
              <select
              class="form-select"
              aria-label="Default select example"
              id="projectname"
              (change)="onProjectChange($event)"
            >
              <option value="" default>All</option>
              @for (item of allProjectNames; track $index) {
              <option value="{{ item }}">{{ item }}</option>
              }
            </select>
            </div>
          </div>
 
          <!--
            Button to create a new JIRA ticket.
          -->

          <button
            class="download-btn"
            matTooltip="Create"
            (click)="createJira()"
          >
            <i class="bi bi-plus-circle-fill download-icon"></i>
          </button>
        </div>
        <!--
          Tab group for ticket details and JIRA integration.
        -->

        <mat-tab-group
          animationDuration="0ms"
          mat-align-tabs="start"
          (selectedTabChange)="onTabClick($event)"
        >
          <!--
            Tab for ticket details form.
          -->

          <mat-tab label="Ticket Details">
            <!--
              Form for submitting ticket analysis details.
            -->

            <form [formGroup]="analysisForm" (ngSubmit)="analysisSubmit()">
              <!--
                Main section for the ticket details form.
              -->

              <div class="row main-sec mt-3">
                <!--
                  Spacer column for layout.
                -->

                <div class="col-md-2"></div>
                <!--
                  Main form column for ticket details.
                -->

                <div class="col-md-8">
                  <!--
                    Row for script name input.
                  -->

                  <div class="row all-margin mb-4">
                    <label for="devicename" class="col-md-3 col-form-label"
                      >Script Name</label
                    >
                    <div class="col-md-9">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="scriptName"
                      />
                      <div
                        *ngIf="
                          analysisFormSubmitted &&
                          analysisForm.controls['scriptName']?.errors
                        "
                        class="text-danger"
                      >
                        <small
                          *ngIf="analysisForm.controls['scriptName']?.errors?.['required']"
                          >Please enter script name.</small
                        >
                      </div>
                    </div>
                  </div>
                  <!--
                    Row for ticket details input.
                  -->

                  <div class="row mb-4">
                    <label for="testtype" class="col-md-3 col-form-label"
                      >Ticket Details<span
                        style="color: red; margin-left: 0.75em"
                        >*</span
                      ></label
                    >
                    <div class="col-md-9">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="ticketDetails"
                      />
                      <div
                        *ngIf="
                          analysisFormSubmitted &&
                          analysisForm.controls['ticketDetails']?.errors
                        "
                        class="text-danger"
                      >
                        <small
                          *ngIf="analysisForm.controls['ticketDetails']?.errors?.['required']"
                          >Please enter ticket details.</small
                        >
                      </div>
                    </div>
                  </div>
                  <!--
                    Row for defect type selection.
                  -->

                  <div class="row mb-4">
                    <label for="testtype" class="col-md-3 col-form-label"
                      >Defect Type
                      <span style="color: red; margin-left: 0.75em"
                        >*</span
                      ></label
                    >
                    <div class="col-md-9">
                      <select
                        class="form-select"
                        aria-label="Default select example"
                        id="devicetype"
                        formControlName="defectType"
                      >
                        <option value="" default>Select</option>
                        @for (item of allDeftesTypes; track $index) {
                        <option value="{{ item }}">{{ item }}</option>
                        }
                      </select>
                      <div
                        *ngIf="
                          analysisFormSubmitted &&
                          analysisForm.controls['defectType']?.errors
                        "
                        class="text-danger"
                      >
                        <small
                          *ngIf="analysisForm.controls['defectType']?.errors?.['required']"
                          >Please select defect type.</small
                        >
                      </div>
                    </div>
                  </div>
                  <!--
                    Row for remarks input.
                  -->

                  <div class="row mb-4">
                    <label for="testtype" class="col-md-3 col-form-label"
                      >Remarks
                      <span style="color: red; margin-left: 0.75em"
                        >*</span
                      ></label
                    >
                    <div class="col-md-9">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="remarks"
                      />
                      <div
                        *ngIf="
                          analysisFormSubmitted &&
                          analysisForm.controls['remarks']?.errors
                        "
                        class="text-danger"
                      >
                        <small
                          *ngIf="analysisForm.controls['remarks']?.errors?.['required']"
                          >Please enter remarks.</small
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <!--
                  Row for the save button.
                -->

                <div class="row mt-2">
                  <!--
                    Column for the save button, right aligned.
                  -->

                  <div class="col-md-12 text-end">
                    <button
                      class="save-btn"
                      type="submit"
                      [disabled]="!analysisForm.valid"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!--
                  Row for the close button.
                -->

                <div class="row mt-2">
                  <!--
                    Column for the close button, right aligned.
                  -->

                  <div class="col-12 d-flex justify-content-end">
                    <button class="close-btn btn btn-secondary w-auto w-100-sm mt-2 mt-md-0" type="button" (click)="onClose()">
                      Close
                    </button>
                 </div>
              </div>
              </div>
            </form>
          </mat-tab>
          <!--
            Tab for JIRA integration grid and controls.
          -->

          <mat-tab label="JIRA Integration" *ngIf="showJiraTab">
            <!--
              Column for filter and create button in JIRA tab.
            -->

            <div class="col-md-12">
              <!--
                Filter by section in JIRA tab.
              -->

              <div class="filterby">
                <!--
                  Filter dropdown placeholder.
                -->

                <div class="filter-drop-down">

                </div>
                <!--
                  Button to create a new JIRA ticket from the JIRA tab.
                -->

                <button class="save-btn" matTooltip="Create">
                  <i class="bi bi-plus-circle-fill download-icon"></i>
                </button>
              </div>
            </div>
            <!--
              Container for the AG Grid displaying JIRA tickets.
            -->

            <div style="width: 100%; height: 340px" [class]="themeClass">
              <!--
                AG Grid Angular component for displaying JIRA tickets.
              -->

              <ag-grid-angular
                style="width: 100%; height: 100%"
                [columnDefs]="columnSchudle"
                [defaultColDef]="{ sortable: true }"
                [rowData]="rowData"
                [pagination]="false"
                [paginationPageSize]="pageSize"
                [paginationPageSizeSelector]="schedulePageSizeSelector"
                [animateRows]="true"
                [context]="this"
                [gridOptions]="gridOptions"
                (gridReady)="onGridReady($event)"
              ></ag-grid-angular>
            </div>
          </mat-tab>
        </mat-tab-group>
    </div>
  </div>
</div>

